<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Diagram Maintenance - iArmada</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="config.js"></script>
</head>
<body class="bg-gray-100 p-4">
  <h1 class="text-2xl font-bold mb-4">Diagram Perawatan Armada</h1>
  <canvas id="chart" class="bg-white rounded shadow p-4"></canvas>

  <script>
    async function loadChart(){
      const res = await fetch(`${API_URL}?action=getMaintenance`);
      const data = await res.json();
      const jenis = [...new Set(data.map(d => d.jenis))];
      const counts = jenis.map(j => data.filter(d => d.jenis===j).length);
      const ctx = document.getElementById('chart').getContext('2d');
      new Chart(ctx, {
        type:'bar',
        data:{labels:jenis, datasets:[{label:'Jumlah Perawatan', data:counts}]},
        options:{responsive:true, scales:{y:{beginAtZero:true}}}
      });
    }
    loadChart();
  </script>
</body>
</html>
